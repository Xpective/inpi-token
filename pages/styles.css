:root{
  color-scheme: light dark;
  --bg:#0b0d10; --bg-elev:#12151a; --text:#e9eef6; --muted:#9fb0c3; --line:#2a3240;
  --primary:#6aa2ff; --primary-ink:#0a1a33; --ok:#29cc7a; --warn:#ffb84d; --error:#ff5d73;
  --ok-ink:#062115; --warn-ink:#221a06; --error-ink:#2a060b;
  --card-radius:14px; --shadow:0 10px 30px rgba(0,0,0,.25);
  --font: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell;
  --accent-purple:#8b5cf6; --accent-cyan:#06b6d4; --accent-ink:#03060a;
  --ring: color-mix(in oklab, var(--primary) 35%, transparent);
}
@media (prefers-color-scheme: light){
  :root{
    --bg:#fff; --bg-elev:#f7f9fc; --text:#111322; --muted:#5a6675; --line:#e7ebf2;
    --primary:#1d64ff; --primary-ink:#f0f5ff; --accent-ink:#00131a;
    --ok-ink:#062115; --warn-ink:#221a06; --error-ink:#2a060b;
    --ring: color-mix(in oklab, var(--primary) 45%, transparent);
  }
}

*{ box-sizing:border-box }
html,body{ height:100% }
body{ margin:0; background:var(--bg); color:var(--text); font:16px/1.45 var(--font) }

.bar{
  position:sticky; top:0; z-index:10; display:flex; align-items:center; gap:14px;
  padding:12px 20px; background:var(--bg-elev); border-bottom:1px solid var(--line);
  backdrop-filter:blur(6px)
}
.logo{ width:44px; height:44px; border-radius:11px; box-shadow:var(--shadow) }
.bar h1{ font-size:20px; margin:0; font-weight:700; letter-spacing:.3px }

main{ max-width:960px; margin:0 auto; padding:28px 20px 80px }
section{ margin:28px 0 }
footer{ border-top:1px solid var(--line); padding:18px 20px; text-align:center; color:var(--muted) }

h2{ margin:0 0 12px; font-size:20px }
h3{ margin:0 0 8px; font-size:18px }
.muted{ color:var(--muted) }

a{ color:var(--primary); text-decoration:none }
@media (hover:hover){ a:hover{ text-decoration:underline } }

.card{
  border:1px solid var(--line); background:var(--bg-elev); border-radius:var(--card-radius);
  padding:16px; box-shadow:var(--shadow)
}

.stats{
  display:grid; gap:10px 14px; grid-template-columns:repeat(auto-fit,minmax(220px,1fr))
}
.stats>div{
  border:1px solid var(--line); border-radius:12px; padding:10px 12px; background:var(--bg-elev)
}

/* --------- Form Controls --------- */
label{ display:block; margin:10px 0 6px; color:var(--muted) }
input, select, textarea{
  width:100%; padding:12px 14px; border-radius:12px; border:1px solid var(--line);
  background:transparent; color:var(--text); outline:none; font:inherit
}
input:focus-visible, select:focus-visible, textarea:focus-visible{
  border-color:var(--primary); box-shadow:0 0 0 3px var(--ring)
}
/* iOS safari zoom fix */
input[type=number]{ font-size:16px }
/* nicer selects */
select{ appearance:none; background-image:
  linear-gradient(45deg, transparent 50%, currentColor 50%),
  linear-gradient(135deg, currentColor 50%, transparent 50%);
background-position: calc(100% - 16px) calc(50% - 3px), calc(100% - 10px) calc(50% - 3px);
background-size: 6px 6px, 6px 6px; background-repeat:no-repeat; padding-right:34px }

/* --------- Buttons --------- */
button, .btn{
  appearance:none; border:0; cursor:pointer; display:inline-block; text-decoration:none;
  padding:10px 14px; border-radius:12px; background:var(--primary); color:#fff; font-weight:600;
  transition:transform .06s ease, opacity .2s ease, box-shadow .2s ease, filter .2s ease
}
button.secondary, .btn.secondary{ background:transparent; color:var(--text); border:1px solid var(--line) }
button:disabled{ opacity:.55; cursor:not-allowed }
button:active, .btn:active{ transform: translateY(1px) }
button:focus-visible, .btn:focus-visible{
  outline:3px solid color-mix(in oklab, var(--primary) 60%, transparent); outline-offset:2px
}
.btn.btn-accent{
  background:linear-gradient(135deg,var(--accent-purple),var(--accent-cyan));
  color:var(--accent-ink); border:0; box-shadow:0 6px 18px rgba(3,6,10,.35)
}
.btn.btn-accent:hover{ filter:brightness(1.05) }
.btn.btn-accent:focus-visible{
  outline:3px solid color-mix(in oklab, var(--accent-cyan) 60%, transparent)
}
/* Loading state for buttons (use: aria-busy="true") */
button[aria-busy="true"]{ position:relative; pointer-events:none; opacity:.9 }
button[aria-busy="true"]::after{
  content:""; position:absolute; right:10px; top:50%; translate:0 -50%;
  width:16px; height:16px; border-radius:50%;
  border:2px solid currentColor; border-top-color:transparent; animation:spin 1s linear infinite
}
@keyframes spin{ to{ transform:rotate(360deg) } }

/* --------- Code/Console --------- */
code{
  background:var(--primary-ink); color:var(--text); padding:2px 6px; border-radius:8px;
  border:1px solid var(--line); word-break:break-all
}
pre{
  margin-top:12px; padding:12px 14px; border-radius:12px; border:1px solid var(--line);
  background:var(--bg-elev); max-height:360px; overflow:auto
}
#intentMsg{
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  line-height:1.35; white-space:pre-wrap
}

/* --------- Layout utilities --------- */
.row{ display:flex; gap:10px; flex-wrap:wrap }
.col{ display:flex; flex-direction:column; gap:.4rem }
.hidden{ display:none !important }
.badge{ display:inline-block; padding:3px 8px; border-radius:999px; font-size:12px; border:1px solid var(--line) }
.badge--ok{ background: color-mix(in oklab, var(--ok) 18%, transparent); color:var(--ok-ink); border-color: color-mix(in oklab, var(--ok) 35%, var(--line)) }
.badge--warn{ background: color-mix(in oklab, var(--warn) 18%, transparent); color:var(--warn-ink); border-color: color-mix(in oklab, var(--warn) 35%, var(--line)) }
.badge--err{ background: color-mix(in oklab, var(--error) 18%, transparent); color:var(--error-ink); border-color: color-mix(in oklab, var(--error) 35%, var(--line)) }
#gateBadge{
  display:inline-block; padding:2px 8px; border-radius:999px; border:1px solid var(--line);
  font-size:12px; color:var(--muted)
}

/* --------- QR + Tables --------- */
.qr{ border:1px solid var(--line); border-radius:8px; image-rendering:pixelated }
canvas.qr{ image-rendering: pixelated; image-rendering: crisp-edges }
#tokTable{ width:100%; border-collapse:collapse }
#tokTable th,#tokTable td{ padding:.4rem; border-bottom:1px solid var(--line) }
#tokTable th{ text-align:left; color:var(--muted); font-weight:600 }
#tokTable td:last-child,#tokTable th:last-child{ text-align:right }

/* --------- Toasts (optional: .toast--ok|--warn|--err) --------- */
.toast{
  position:fixed; left:50%; bottom:18px; translate:-50% 0;
  background:var(--bg-elev); color:var(--text); border:1px solid var(--line);
  border-radius:12px; padding:10px 14px; box-shadow:var(--shadow); z-index:9999
}
.toast--ok{ border-color: color-mix(in oklab, var(--ok) 40%, var(--line)) }
.toast--warn{ border-color: color-mix(in oklab, var(--warn) 40%, var(--line)) }
.toast--err{ border-color: color-mix(in oklab, var(--error) 40%, var(--line)) }

/* --------- Dialog/Popup Basics (falls <dialog> genutzt) --------- */
dialog{
  border:1px solid var(--line); background:var(--bg-elev); color:var(--text);
  border-radius:14px; padding:0; box-shadow:var(--shadow);
}
dialog::backdrop{ background: rgba(0,0,0,.4) }

/* --------- Small helpers --------- */
.kbd{
  display:inline-block; padding:2px 6px; border-radius:6px; border:1px solid var(--line);
  background:var(--bg-elev); font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size:12px
}
.sr-only{
  position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden;
  clip:rect(0,0,0,0); white-space:nowrap; border:0
}

/* --------- Responsive/Reduced Motion --------- */
@media (max-width:560px){
  .bar h1{ font-size:18px } .logo{ width:38px; height:38px }
  main{ padding:20px 16px 60px }
}
@media (prefers-reduced-motion: reduce){
  *{ animation:none !important; transition:none !important }
}