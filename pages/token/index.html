<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Inpinity (INPI) – Presale</title>
    <meta name="description" content="Inpinity Token (INPI) – Presale mit USDC auf Solana, Early-Claim & NFT-Rabatt."/>
    
    <!-- Schlanke, Proxy-freundliche CSP -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      connect-src 'self' https://inpinity.online;
      img-src 'self' data: blob:;
      script-src 'self' https://cdn.jsdelivr.net 'unsafe-inline';
      style-src 'self' 'unsafe-inline';
      object-src 'none';
      base-uri 'none';
    ">
  
    <!-- Build-Tag zum Cache-Busting -->
    <script>window.INPI_BUILD = "v-2025-08-29-1";</script>
  
    <link rel="preconnect" href="https://cdn.jsdelivr.net"/>
    <link rel="stylesheet" href="./styles.css?v=v-2025-08-29-1"/>
  </head>
<body>
  <header class="bar">
    <img src="./inpi.png" class="logo" alt="INPI Logo"/>
    <h1>Inpinity (INPI)</h1>
    <div class="row" style="margin-left:auto;gap:.5rem;align-items:center">
      <a class="btn btn-accent" href="https://inpinity.online/pillary/app" target="_blank" rel="noopener">PI&nbsp;Pyramide</a>
      <code id="walletAddr">—</code>
      <button id="btnConnect" disabled>Verbinden</button>
    </div>
  </header>

  <main>
    <section>
      <h2>Status</h2>
      <div class="stats">
        <div><b>Presale-Phase:</b> <span id="presaleState">—</span></div>
        <div><b>TGE in:</b> <span id="tgeTime">tbd</span></div>
        <div><b>Preis:</b> <span id="p0">—</span></div>
      </div>
    </section>

    <section>
      <h2>Deine Wallet</h2>
      <div class="stats">
        <div><b>USDC:</b> <span id="usdcBal">—</span></div>
        <div><b>INPI:</b> <span id="inpiBal">—</span></div>
      </div>
    </section>

    <section class="card" id="depositBox">
      <h2>Presale Einzahlung (USDC auf Solana)</h2>
      <p class="row" style="gap:.5rem;align-items:center">
        <b>ATA (Info/Bilanz):</b>
        <code id="depositAddr">—</code>
        <button id="btnCopyDeposit" class="secondary">Kopieren</button>
        <a id="depositSolscan" href="#" target="_blank" rel="noopener" style="display:none">(Solscan)</a>
      </p>
      <p class="muted" style="margin:.25rem 0"><b>Owner (Ziel-Pubkey):</b> <span id="depositOwner">—</span></p>
      <p class="muted">Sende nur <b>USDC (SPL)</b>. Die Presale-QR nutzt den <b>Owner-Pubkey</b> und leitet automatisch an die USDC-ATA weiter.</p>
    </section>

    <section>
      <h2>Presale Intent</h2>
      <label>USDC Betrag
        <input id="inpAmount" type="number" min="1" step="0.000001" value="10"/>
      </label>
      <div><small>Erwartete Zuteilung: <b id="expectedInpi">—</b></small></div>
      <div style="margin-top:.6rem;display:flex;gap:.6rem;flex-wrap:wrap">
        <button id="btnPresaleIntent">Intent senden</button>
        <button id="btnHowTo" class="secondary">Kurzanleitung</button>
      </div>

      <div id="payArea" class="card" style="margin-top:.8rem;display:none">
        <h3>Jetzt bezahlen (Presale)</h3>
        <div class="row" style="gap:1rem;align-items:center;flex-wrap:wrap">
          <!-- IMG wird beim QR-Render automatisch in ein Canvas getauscht -->
          <img id="inpi-qr" alt="Scan & pay via Solana Pay" width="240" height="240" class="qr" style="display:none"/>
          <div class="col">
            <p style="margin:0 0 .5rem 0"><b>So zahlst du:</b> QR mit Wallet scannen <u>oder</u> USDC-Adresse oben kopieren (SPL-USDC, 6 Dezimalstellen).</p>
            <div class="row" style="gap:.5rem;flex-wrap:wrap;margin-top:.25rem">
              <!-- Optional: Deep-Links (werden aktuell nicht benutzt, bleiben aber vorbereitet) -->
              <a id="link-phantom"  class="btn secondary" href="#" target="_blank" rel="noopener" style="display:none">In&nbsp;Phantom&nbsp;öffnen</a>
              <a id="link-solflare" class="btn secondary" href="#" target="_blank" rel="noopener" style="display:none">In&nbsp;Solflare&nbsp;öffnen</a>
            </div>
            <p class="muted" style="margin:.4rem 0 0 0">Bitte vom <b>selben Wallet</b> senden, das den Intent registriert hat.</p>
          </div>
        </div>
      </div>

      <pre id="intentMsg" role="status" aria-live="polite"></pre>
    </section>

    <section class="card" id="earlyBox" style="display:none">
      <h2>Claim (Early)</h2>
      <p>Vorzeitiger Erhalt deiner INPI vor TGE. <b>Gebühr: 1&nbsp;USDC</b>.</p>
      <div class="stats"><div><b>Claimbar:</b> <span id="earlyExpected">—</span></div></div>
      <div class="row" style="gap:.6rem;flex-wrap:wrap">
        <button id="btnClaim">Claim (1&nbsp;USDC Fee)</button>
        <span class="muted">Auszahlung, sobald die Fee erkannt ist.</span>
      </div>

      <div id="earlyArea" class="card" style="margin-top:.8rem;display:none">
        <h3>Fee zahlen (1&nbsp;USDC)</h3>
        <div class="row" style="gap:1rem;align-items:center;flex-wrap:wrap">
          <!-- IMG wird beim QR-Render automatisch in ein Canvas getauscht -->
          <img id="early-qr" alt="Scan & pay Early-Claim Fee" width="240" height="240" class="qr" style="display:none"/>
          <div class="col">
            <p class="muted" id="earlyMsg"></p>
            <div style="margin-top:.6rem">
              <label class="muted">Optional: Fee-Tx-Signatur (beschleunigt die Zuordnung)</label>
              <input id="earlySig" type="text" placeholder="Transaktionssignatur einfügen" style="width:100%"/>
              <button id="btnEarlyConfirm" class="secondary" style="margin-top:.4rem">Ich habe gezahlt</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Tokenomics-Box wird von app.js dynamisch eingefügt -->
  </main>

  <footer>
    <small>
      © Inpinity • <a href="https://inpinity.online" target="_blank" rel="noopener">Website</a> •
      <a href="/docs/whitepaper-v1.pdf" target="_blank" rel="noopener">Whitepaper</a> •
      <a href="/.well-known/inpi.json" target="_blank" rel="noopener">Verifikation</a>
    </small>
  </footer>

  <!-- web3.js IIFE (kein type="module"); app.js kümmert sich um Fallback-Laden -->
  <script defer src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.98.4/lib/index.iife.min.js"></script>
    <!-- Keine feste web3-Einbindung: app.js lädt IIFE selbst mit Version -->
  <!-- Keine feste web3-Einbindung: app.js lädt IIFE selbst mit Version -->
  <script defer src="./app.js?v=v-2025-08-29-1"></script>
</body>
</html>